<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Traffic Arbitration</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="/static/css/admin.css" rel="stylesheet">
    <style>
        .navbar-brand {
            font-weight: bold;
            font-size: 1.25rem;
        }
        
        .dropdown-menu {
            border: none;
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
            border-radius: 0.5rem;
        }
        
        .dropdown-item {
            padding: 0.5rem 1rem;
            transition: background-color 0.2s ease;
        }
        
        .dropdown-item:hover {
            background-color: rgba(13, 110, 253, 0.1);
            color: var(--bs-primary);
        }
        
        .nav-link {
            padding: 0.75rem 1rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .nav-link:hover {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 0.375rem;
        }
        
        .navbar-toggler {
            border: none;
            padding: 0.25rem 0.5rem;
        }
        
        .navbar-toggler:focus {
            box-shadow: none;
        }
        
        @media (max-width: 991.98px) {
            .dropdown-menu {
                border: none;
                box-shadow: none;
                background-color: transparent;
            }
            
            .dropdown-item {
                color: rgba(255, 255, 255, 0.8);
                padding: 0.5rem 1.5rem;
            }
            
            .dropdown-item:hover {
                background-color: rgba(255, 255, 255, 0.1);
                color: white;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="/admin">
                <i class="bi bi-speedometer2 me-2"></i>
                Traffic Arbitration Admin
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <!-- Content Management -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="bi bi-file-earmark-text me-1"></i>
                            Content
                        </a>
                        <ul class="dropdown-menu">
                            <li><h6 class="dropdown-header">Articles</h6></li>
                            <li><a class="dropdown-item" href="/admin/articles">
                                <i class="bi bi-list-ul me-2"></i>All Articles
                            </a></li>
                            <li><a class="dropdown-item" href="/admin/articles/create">
                                <i class="bi bi-plus-circle me-2"></i>Create Article
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><h6 class="dropdown-header">Media</h6></li>
                            <li><a class="dropdown-item" href="/admin/media/gallery">
                                <i class="bi bi-images me-2"></i>Media Gallery
                            </a></li>
                            <li><a class="dropdown-item" href="/admin/media/upload">
                                <i class="bi bi-upload me-2"></i>Upload Files
                            </a></li>
                        </ul>
                    </li>

                    <!-- Content Pipeline -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="bi bi-arrow-repeat me-1"></i>
                            Pipeline
                        </a>
                        <ul class="dropdown-menu">
                            <li><h6 class="dropdown-header">Sources</h6></li>
                            <li><a class="dropdown-item" href="/admin/pipeline/sources">
                                <i class="bi bi-database me-2"></i>Content Sources
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><h6 class="dropdown-header">Content Processing</h6></li>
                            <li><a class="dropdown-item" href="/admin/pipeline/previews">
                                <i class="bi bi-eye me-2"></i>Article Previews
                                <span class="badge bg-warning ms-2">New</span>
                            </a></li>
                            <li><a class="dropdown-item" href="/admin/pipeline/external-articles">
                                <i class="bi bi-file-earmark-text me-2"></i>External Articles
                            </a></li>
                        </ul>
                    </li>

                    <!-- Settings & Configuration -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="bi bi-gear me-1"></i>
                            Settings
                        </a>
                        <ul class="dropdown-menu">
                            <li><h6 class="dropdown-header">Taxonomy</h6></li>
                            <li><a class="dropdown-item" href="/admin/settings/categories">
                                <i class="bi bi-tags me-2"></i>Categories
                            </a></li>
                            <li><a class="dropdown-item" href="/admin/settings/geo">
                                <i class="bi bi-geo-alt me-2"></i>Geo Tags
                            </a></li>
                            <li><a class="dropdown-item" href="/admin/settings/tags">
                                <i class="bi bi-hash me-2"></i>Tags
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><h6 class="dropdown-header">Configuration</h6></li>
                            <li><a class="dropdown-item" href="/admin/settings/locales">
                                <i class="bi bi-translate me-2"></i>Locales
                            </a></li>
                            <li><a class="dropdown-item" href="/admin/settings/content-sources">
                                <i class="bi bi-link-45deg me-2"></i>Content Sources
                            </a></li>
                        </ul>
                    </li>
                </ul>

                <!-- Right side navigation -->
                <ul class="navbar-nav">
                    <!-- Quick Actions -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="bi bi-lightning me-1"></i>
                            Quick Actions
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="/admin/articles/create">
                                <i class="bi bi-plus-circle me-2 text-success"></i>New Article
                            </a></li>
                            <li><a class="dropdown-item" href="/admin/media/upload">
                                <i class="bi bi-upload me-2 text-primary"></i>Upload Media
                            </a></li>
                            <li><a class="dropdown-item" href="/admin/pipeline/sources">
                                <i class="bi bi-database me-2 text-info"></i>Add Source
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="/admin">
                                <i class="bi bi-speedometer2 me-2 text-warning"></i>Dashboard
                            </a></li>
                        </ul>
                    </li>

                    <!-- User Menu -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="bi bi-person-circle me-1"></i>
                            Admin
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><h6 class="dropdown-header">User Menu</h6></li>
                            <li><a class="dropdown-item" href="#">
                                <i class="bi bi-person me-2"></i>Profile
                            </a></li>
                            <li><a class="dropdown-item" href="#">
                                <i class="bi bi-gear me-2"></i>Settings
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#">
                                <i class="bi bi-box-arrow-right me-2 text-danger"></i>Logout
                            </a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb" class="bg-light border-bottom">
        <div class="container-fluid">
            <ol class="breadcrumb mb-0 py-2">
                <li class="breadcrumb-item">
                    <a href="/admin" class="text-decoration-none">
                        <i class="bi bi-house-door me-1"></i>Dashboard
                    </a>
                </li>
                {% block breadcrumb %}{% endblock %}
            </ol>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container-fluid py-4">
        <!-- Alerts -->
        {% if errors %}
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                <i class="bi bi-exclamation-triangle me-2"></i>
                <strong>Error:</strong> 
                {% for error in errors %}
                    {{ error }}{% if not loop.last %}<br>{% endif %}
                {% endfor %}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        {% endif %}

        {% if success_messages %}
            {% for message in success_messages %}
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    <i class="bi bi-check-circle me-2"></i>
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        {% endif %}

        {% if info_messages %}
            {% for message in info_messages %}
                <div class="alert alert-info alert-dismissible fade show" role="alert">
                    <i class="bi bi-info-circle me-2"></i>
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        {% endif %}

        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="bg-light border-top mt-auto py-3">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-6">
                    <small class="text-muted">
                        Â© 2025 Traffic Arbitration Admin Panel
                    </small>
                </div>
                <div class="col-md-6 text-end">
                    <small class="text-muted">
                        Powered by FastAPI & Bootstrap 5.3
                    </small>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Auto-hide alerts after 5 seconds
        document.addEventListener('DOMContentLoaded', function() {
            const alerts = document.querySelectorAll('.alert:not(.alert-permanent)');
            alerts.forEach(alert => {
                setTimeout(() => {
                    const bsAlert = new bootstrap.Alert(alert);
                    bsAlert.close();
                }, 5000);
            });
        });

        // Active navigation highlighting
        document.addEventListener('DOMContentLoaded', function() {
            const currentPath = window.location.pathname;
            const navLinks = document.querySelectorAll('.navbar-nav .nav-link');
            
            navLinks.forEach(link => {
                const href = link.getAttribute('href');
                if (href) {
                    // Special handling for dashboard home page
                    if (href === '/admin' && (currentPath === '/admin' || currentPath === '/')) {
                        link.classList.add('active');
                    } else if (href !== '/admin' && currentPath.startsWith(href)) {
                        link.classList.add('active');
                        const parentDropdown = link.closest('.dropdown');
                        if (parentDropdown) {
                            parentDropdown.querySelector('.dropdown-toggle').classList.add('active');
                        }
                    }
                }
            });
        });

        // Confirm delete actions
        function confirmDelete(message = 'Are you sure you want to delete this item?') {
            return confirm(message);
        }

        // Loading state for buttons
        function setButtonLoading(button, loading = true, originalText = null) {
            if (loading) {
                if (!originalText) originalText = button.innerHTML;
                button.setAttribute('data-original-text', originalText);
                button.innerHTML = '<span class="spinner-border spinner-border-sm me-1" role="status"></span>Loading...';
                button.disabled = true;
            } else {
                const originalText = button.getAttribute('data-original-text');
                if (originalText) {
                    button.innerHTML = originalText;
                    button.removeAttribute('data-original-text');
                }
                button.disabled = false;
            }
        }
    </script>

    {% block scripts %}{% endblock %}
</body>
</html>